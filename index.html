<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dan's Book Tracker 2026</title>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.tailwindcss.com"></script>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Source+Sans+3:wght@400;600&display=swap" rel="stylesheet">

<style>
body {
    font-family: 'Source Sans 3', sans-serif;
    background-color: #f4f1ea;
    color: #2c2c2c;
}

h1, h2, h3, .book-title {
    font-family: 'Playfair Display', serif;
}

.star {
    color: #c6a75e;
    font-size: 1.2em;
}

.progress-marker {
    position: absolute;
    width: 2px;
    background: red;
    top: 0;
    bottom: 0;
}

.progress-container {
    position: relative;
    height: 1.5rem;
}

.progress-text {
    position: absolute;
    width: 100%;
    text-align: center;
    font-weight: bold;
    top: 0;
    line-height: 1.5rem;
    color: #000;
}

.chart-container {
    width: 10rem;
    height: 10rem;
    position: relative;
}

.chart-title {
    text-align: center;
    font-weight: bold;
    margin-bottom: 0.25rem;
    font-family: 'Playfair Display', serif;
    color: #1f3d2b;
}

.book-item {
    background: #ffffff;
    padding: 1rem;
    border-radius: 0.75rem;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0 3px 8px rgba(0,0,0,0.08);
    border: 1px solid #e8e3d9;
}

.book-item:hover {
    transform: translateY(-6px);
    box-shadow: 0 8px 18px rgba(0,0,0,0.15);
}

.book-title {
    font-weight: 700;
    font-size: 1.3rem;
    margin-bottom: 0.75rem;
}

.book-content {
    display: flex;
    gap: 1rem;
    align-items: flex-start;
}

.book-cover {
    width: 120px;
    height: 180px;
    object-fit: cover;
    border-radius: 0.25rem;
}

.book-info {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.description-box {
    background: #ffffff;
    padding: 1.25rem;
    border-radius: 0.75rem;
    box-shadow: 0 3px 8px rgba(0,0,0,0.08);
    border-left: 5px solid #c6a75e;
}
</style>
</head>

<body class="p-6">

<h1 class="text-4xl mb-8 text-center" style="color:#1f3d2b;">
ðŸ“š Dan's Book Tracker 2026
</h1>

<div class="grid md:grid-cols-2 gap-6 mb-6">

<!-- Currently Reading -->
<div id="currentlyReading" class="bg-white p-4 rounded-lg shadow-lg overflow-auto max-h-[400px]"></div>

<!-- Right Side -->
<div class="space-y-4">
    <div class="description-box">
        In 2026 I decided I would read at least 100 books. I decided to track them in a spreadsheet and then eventually I made this to show my progress and relevant stats in a nicer form.
    </div>
    <div id="stats" class="bg-white p-4 rounded-lg shadow-lg text-center"></div>
</div>

<!-- Pie Charts -->
<div class="bg-white p-4 rounded-lg shadow-lg flex justify-around flex-wrap">
    <div class="text-center">
        <div class="chart-title">Genre</div>
        <div class="chart-container"><canvas id="genreChart"></canvas></div>
    </div>
    <div class="text-center">
        <div class="chart-title">Gender</div>
        <div class="chart-container"><canvas id="genderChart"></canvas></div>
    </div>
    <div class="text-center">
        <div class="chart-title">Language</div>
        <div class="chart-container"><canvas id="languageChart"></canvas></div>
    </div>
</div>

<!-- Bars -->
<div class="space-y-4">
    <div id="fictionBar" class="bg-white p-4 rounded-lg shadow-lg"></div>
    <div id="readProgressBar" class="bg-white p-4 rounded-lg shadow-lg"></div>
</div>

</div>

<!-- Finished Books -->
<div id="bookList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-4"></div>

<!-- LinkedIn -->
<div class="mt-10 text-center">
    <a href="https://www.linkedin.com/in/daniel-moore-485b92120/" 
       target="_blank"
       class="underline"
       style="color:#1f3d2b;">
       Connect with me on LinkedIn
    </a>
</div>

<script>

const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSDLnokY9AAjmaXbQ4Ofk-jH6eK1mn9bXcgAid1xWU_2MbtoraDDL5IzoEYT7PPT-numSfmt0EJoS6a/pub?gid=1531654911&single=true&output=csv";

let genreChartInstance=null, genderChartInstance=null, languageChartInstance=null;

async function fetchBooks(){
    const res = await fetch(CSV_URL);
    const text = await res.text();
    const { data } = Papa.parse(text,{header:false,skipEmptyLines:true});

    return data.slice(5).map(row=>({
        Book: row[0]||"",
        Author: row[1]||"",
        Fiction: row[2]||"",
        Read: row[3]||"",
        "Date Finished": row[4]||"",
        Rating: row[5]||"",
        Gender: row[7]||"",
        Language: row[8]||"",
        Genre: row[9]?.trim() || "Other",
        Cover: row[10]||""
    }));
}

function renderStars(rating){
    if(!rating) return "-";
    let r=parseFloat(rating);
    return 'â˜…'.repeat(Math.floor(r)) + 'â˜†'.repeat(5-Math.floor(r));
}

function renderCurrentlyReading(books){
    const div=document.getElementById("currentlyReading");
    div.innerHTML=`<p class="text-lg font-semibold mb-2">ðŸ“– Currently Reading</p>`;
    const current=books.filter(b=>!b.Read||b.Read.toLowerCase()!=="finished");
    if(!current.length){div.innerHTML+="No books currently reading";return;}

    current.forEach(b=>{
        div.innerHTML+=`
        <div class="book-item">
            <p class="book-title">${b.Book}</p>
            <div class="book-content">
                ${b.Cover?`<img class="book-cover" src="${b.Cover}">`:""}
                <div class="book-info">
                    <p><strong>Author:</strong> ${b.Author}</p>
                    <p><strong>Genre:</strong> ${b.Genre||b.Fiction}</p>
                    <p><strong>Language:</strong> ${b.Language}</p>
                </div>
            </div>
        </div>`;
    });
}

function renderBooks(books){
    const div=document.getElementById("bookList");
    div.innerHTML="";
    books.forEach(b=>{
        div.innerHTML+=`
        <div class="book-item">
            <p class="book-title">${b.Book}</p>
            <div class="book-content">
                ${b.Cover?`<img class="book-cover" src="${b.Cover}">`:""}
                <div class="book-info">
                    <p><strong>Author:</strong> ${b.Author}</p>
                    <p><strong>Genre:</strong> ${b.Genre||b.Fiction}</p>
                    <p><strong>Language:</strong> ${b.Language}</p>
                    <p><strong>Date Finished:</strong> ${b["Date Finished"]}</p>
                    <p><strong>Rating:</strong> <span class="star">${renderStars(b.Rating)}</span></p>
                </div>
            </div>
        </div>`;
    });
}

function renderStatsAndBars(books){
    const finished=books.filter(b=>b.Read&&b.Read.toLowerCase()==="finished").length;
    const remaining=Math.max(100-finished,0);

    document.getElementById("stats").innerHTML=`
        <p><strong>Finished:</strong> ${finished}</p>
        <p><strong>Remaining to 100:</strong> ${remaining}</p>
    `;

    const percent=Math.min((finished/100)*100,100);

    document.getElementById("readProgressBar").innerHTML=`
        <p class="font-semibold mb-1">Reading Progress</p>
        <div style="background:#ddd;height:1.5rem;position:relative;">
            <div style="background:#2e7d32;height:1.5rem;width:${percent}%"></div>
            <div class="progress-text">${finished}/100</div>
        </div>
    `;

    const fiction=books.filter(b=>b.Fiction.toLowerCase().includes("fiction")).length;
    const nonFiction=books.filter(b=>b.Fiction.toLowerCase().includes("non-fiction")).length;
    const total=fiction+nonFiction;

    document.getElementById("fictionBar").innerHTML=`
        <p class="font-semibold mb-1">Fiction vs Non-Fiction</p>
        <div style="background:#ddd;height:1.5rem;display:flex;">
            <div style="background:#355c7d;width:${total?fiction/total*100:0}%;"></div>
            <div style="background:#d9a441;width:${total?nonFiction/total*100:0}%;"></div>
        </div>
    `;
}

function renderPieChart(id,dataObj){
    const ctx=document.getElementById(id);
    return new Chart(ctx,{
        type:'pie',
        data:{labels:Object.keys(dataObj),datasets:[{data:Object.values(dataObj)}]},
        options:{responsive:true,maintainAspectRatio:false}
    });
}

function renderCharts(books){
    const genre={},gender={},lang={};
    books.forEach(b=>{
        genre[b.Genre]=(genre[b.Genre]||0)+1;
        if(b.Gender) gender[b.Gender]=(gender[b.Gender]||0)+1;
        if(b.Language) lang[b.Language]=(lang[b.Language]||0)+1;
    });
    renderPieChart("genreChart",genre);
    renderPieChart("genderChart",gender);
    renderPieChart("languageChart",lang);
}

async function init(){
    const books=await fetchBooks();
    renderCurrentlyReading(books);
    renderStatsAndBars(books);
    renderBooks(books.filter(b=>b.Read&&b.Read.toLowerCase()==="finished"));
    renderCharts(books);
}

init();
</script>

</body>
</html>