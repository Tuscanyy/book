<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dan's Book Tracker 2026</title>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.tailwindcss.com"></script>

<!-- Medieval Font -->
<link href="https://fonts.googleapis.com/css2?family=Metamorphous&display=swap" rel="stylesheet">

<style>
body { 
  font-family: Arial, sans-serif; 
  background-color: #f9fafb; 
}

h1, .book-title, .chart-title {
  font-family: 'Metamorphous', serif;
}

.star { color: gold; font-size: 1.2em; }

.progress-marker { 
  position: absolute; 
  width: 2px; 
  background: white; 
  top: 0; 
  bottom: 0; 
}

.progress-text { 
  position: absolute; 
  width: 100%; 
  text-align: center; 
  font-weight: bold; 
  top:0; 
  line-height:1.5rem; 
}

.chart-container { width: 10rem; height: 10rem; position: relative; }

.chart-title { text-align:center; font-weight:bold; margin-bottom:0.25rem; }

.book-item { 
  background: #ffffff; 
  padding:1rem; 
  border-radius:0.5rem; 
  transition: transform 0.2s, box-shadow 0.2s; 
  box-shadow: 0 1px 3px rgba(0,0,0,0.1); 
}

.book-item:hover { 
  transform: translateY(-4px); 
  box-shadow: 0 4px 10px rgba(0,0,0,0.2); 
}

.book-title { 
  font-weight: 700; 
  font-size: 1.25rem; 
  margin-bottom: 0.75rem; 
}

.book-content { display:flex; gap:1rem; align-items:flex-start; }

.book-cover { 
  width: 120px; 
  height: 180px; 
  object-fit: cover; 
  border-radius:0.25rem; 
}

.book-info { display: flex; flex-direction: column; }

.description-box { 
  background:white; 
  padding:1rem; 
  border-radius:0.5rem; 
  box-shadow: 0 1px 3px rgba(0,0,0,0.1); 
  margin-bottom:1rem; 
}
</style>
</head>

<body class="p-6">

<h1 class="text-3xl font-bold mb-6 text-center">
ðŸ“š Dan's Book Tracker 2026
</h1>

<div class="grid md:grid-cols-2 gap-6 mb-6">

<!-- Currently Reading -->
<div id="currentlyReading" class="bg-white p-4 rounded-lg shadow-lg overflow-auto max-h-[400px]"></div>

<!-- Right Side -->
<div class="space-y-4">
  <div class="description-box">
    In 2026 I decided I would read at least 100 books. I tracked them in a spreadsheet and eventually built this dashboard to show my progress and stats in a nicer form.
  </div>
  <div id="stats" class="bg-white p-4 rounded-lg shadow-lg text-center"></div>
</div>

<!-- Pie Charts -->
<div class="bg-white p-4 rounded-lg shadow-lg flex justify-around flex-wrap gap-6">
  <div class="text-center">
    <div class="chart-title">Genre</div>
    <div class="chart-container"><canvas id="genreChart"></canvas></div>
  </div>

  <div class="text-center">
    <div class="chart-title">Language</div>
    <div class="chart-container"><canvas id="languageChart"></canvas></div>
  </div>

  <div class="text-center">
    <div class="chart-title">Country of Origin</div>
    <div class="chart-container"><canvas id="countryChart"></canvas></div>
  </div>
</div>

<!-- Bars -->
<div class="space-y-4">
  <div id="fictionBar" class="bg-white p-4 rounded-lg shadow-lg"></div>
  <div id="genderBar" class="bg-white p-4 rounded-lg shadow-lg"></div>
  <div id="readProgressBar" class="bg-white p-4 rounded-lg shadow-lg"></div>
</div>

</div>

<!-- Finished Books -->
<div id="bookList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-4"></div>

<!-- LinkedIn -->
<div class="mt-6 text-center">
  <a href="https://www.linkedin.com/in/daniel-moore-485b92120/" target="_blank" class="text-blue-600 underline">
    Connect with me on LinkedIn
  </a>
</div>

<script>
const CSV_URL = ""https://docs.google.com/spreadsheets/d/e/2PACX-1vSDLnokY9AAjmaXbQ4Ofk-jH6eK1mn9bXcgAid1xWU_2MbtoraDDL5IzoEYT7PPT-numSfmt0EJoS6a/pub?gid=1531654911&single=true&output=csv"";

let genreChartInstance, languageChartInstance, countryChartInstance;

async function fetchBooks(){
  const res = await fetch(CSV_URL);
  const text = await res.text();
  const { data } = Papa.parse(text,{header:false,skipEmptyLines:true});

  return data.slice(5).map(row=>({
    Book: row[0]||"",
    Author: row[1]||"",
    Fiction: row[2]||"",
    Read: row[3]||"",
    "Date Finished": row[4]||"",
    Rating: row[5]||"",
    Gender: row[7]||"",
    Language: row[8]||"",
    Genre: row[9]?.trim() || "Other",
    Cover: row[10]||"",
    Country: row[11] || "Unknown"
  }));
}

function renderPieChart(id, dataObj, instanceRef){
  if(instanceRef) instanceRef.destroy();

  return new Chart(document.getElementById(id),{
    type:'pie',
    data:{
      labels:Object.keys(dataObj),
      datasets:[{
        data:Object.values(dataObj),
        backgroundColor:[
          "#8B0000","#556B2F","#483D8B",
          "#DAA520","#2F4F4F","#B22222",
          "#6B8E23","#4682B4","#A0522D"
        ]
      }]
    },
    options:{responsive:true,maintainAspectRatio:false}
  });
}

function renderCharts(books){
  const genre={}, language={}, country={};

  books.forEach(b=>{
    genre[b.Genre]=(genre[b.Genre]||0)+1;
    if(b.Language) language[b.Language]=(language[b.Language]||0)+1;
    country[b.Country]=(country[b.Country]||0)+1;
  });

  genreChartInstance = renderPieChart("genreChart",genre,genreChartInstance);
  languageChartInstance = renderPieChart("languageChart",language,languageChartInstance);
  countryChartInstance = renderPieChart("countryChart",country,countryChartInstance);
}

function renderStatsAndBars(books){

  const fiction = books.filter(b=>b.Fiction.toLowerCase().includes("fiction")).length;
  const nonFiction = books.filter(b=>b.Fiction.toLowerCase().includes("non-fiction")).length;

  const male = books.filter(b=>b.Gender.toLowerCase().includes("male")).length;
  const female = books.filter(b=>b.Gender.toLowerCase().includes("female")).length;

  const finished = books.filter(b=>b.Read && b.Read.toLowerCase()==="finished").length;
  const percent = Math.min((finished/100)*100,100);

  document.getElementById("stats").innerHTML=`
    <p><strong>Finished:</strong> ${finished}</p>
    <p><strong>Remaining to 100:</strong> ${100-finished}</p>
  `;

  document.getElementById("fictionBar").innerHTML=`
    <p class="font-semibold mb-1">Fiction vs Non-Fiction</p>
    <div class="w-full bg-gray-300 h-6 flex relative">
      <div style="background:#355c7d;width:${fiction/(fiction+nonFiction)*100}%"></div>
      <div style="background:#d9a441;width:${nonFiction/(fiction+nonFiction)*100}%"></div>
      <div class="progress-text">Fiction: ${fiction} | Non-Fiction: ${nonFiction}</div>
    </div>
  `;

  document.getElementById("genderBar").innerHTML=`
    <p class="font-semibold mb-1">Male vs Female Authors</p>
    <div class="w-full bg-gray-300 h-6 flex relative">
      <div style="background:#6b7280;width:${male/(male+female)*100}%"></div>
      <div style="background:#ec4899;width:${female/(male+female)*100}%"></div>
      <div class="progress-text">Male: ${male} | Female: ${female}</div>
    </div>
  `;

  document.getElementById("readProgressBar").innerHTML=`
    <p class="font-semibold mb-1">Reading Progress</p>
    <div class="w-full bg-gray-300 h-6 relative">
      <div style="background:#2e7d32;width:${percent}%;height:100%"></div>
      <div class="progress-text">${finished}/100</div>
    </div>
  `;
}

async function init(){
  const books = await fetchBooks();
  renderStatsAndBars(books);
  renderCharts(books);
}

init();
</script>

</body>
</html>