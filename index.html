<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dan's Book Tracker 2026</title>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.tailwindcss.com"></script>

<link href="https://fonts.googleapis.com/css2?family=Metamorphous&display=swap" rel="stylesheet">

<style>
body { 
  font-family: Arial, sans-serif; 
  background-color: #0f172a;
  background-image: radial-gradient(rgba(255,255,255,0.04) 1px, transparent 1px);
  background-size: 20px 20px;
  color: #f8fafc;
}

h1, .book-title, .chart-title {
  font-family: 'Metamorphous', serif;
}

.title-divider {
  width:150px;
  height:4px;
  background:#c9a227;
  margin:0 auto 2rem auto;
  border-radius:2px;
}

.card {
  background:#f8f5f0;
  color:#1e293b;
  border-radius:0.75rem;
  padding:1rem;
  box-shadow:0 8px 20px rgba(0,0,0,0.35);
}

.book-item { 
  background:#f8f5f0;
  color:#1e293b;
  padding:1rem; 
  border-radius:0.75rem; 
  transition: all 0.25s ease;
  box-shadow:0 6px 18px rgba(0,0,0,0.25);
}

.book-item:hover { 
  transform: translateY(-6px); 
  box-shadow:0 14px 30px rgba(0,0,0,0.4);
}

.book-title { 
  font-weight:700; 
  font-size:1.3rem; 
  margin-bottom:0.5rem; 
}

.book-content { 
  display:flex; 
  gap:1rem; 
  align-items:flex-start; 
}

.book-cover { 
  width:120px; 
  height:180px; 
  object-fit:cover; 
  border-radius:0.5rem;
  box-shadow:0 4px 12px rgba(0,0,0,0.3);
}

.book-info { flex:1; }

.chart-container { width:12rem; height:12rem; position:relative; }

.progress-text { 
  position:absolute; 
  width:100%; 
  text-align:center; 
  font-weight:bold; 
  top:0; 
  line-height:2rem; 
  color:white;
}

.progress-marker { 
  position:absolute; 
  width:2px; 
  background:white; 
  top:0; 
  bottom:0; 
}
</style>
</head>

<body class="p-8">

<h1 class="text-4xl font-bold text-center mb-2">ðŸ“š Dan's Book Tracker 2026</h1>
<div class="title-divider"></div>

<div class="grid md:grid-cols-2 gap-6 mb-8">

  <div id="currentlyReading" class="card max-h-[400px] overflow-auto"></div>

  <div class="space-y-4">
    <div class="card">
      <p>
        In 2026 I decided I would read at least 100 books.
        I track them in a spreadsheet and built this dashboard
        to visualise my progress and reading stats.
      </p>
    </div>
    <div id="stats" class="card text-center"></div>
  </div>

  <div class="card flex justify-around flex-wrap gap-6">
    <div>
      <div class="chart-title text-center font-bold mb-2">Genre</div>
      <div class="chart-container"><canvas id="genreChart"></canvas></div>
    </div>
    <div>
      <div class="chart-title text-center font-bold mb-2">Language</div>
      <div class="chart-container"><canvas id="languageChart"></canvas></div>
    </div>
    <div>
      <div class="chart-title text-center font-bold mb-2">Country</div>
      <div class="chart-container"><canvas id="countryChart"></canvas></div>
    </div>
  </div>

  <div class="space-y-4">
    <div id="readProgressBar" class="card relative"></div>
    <div id="fictionBar" class="card"></div>
    <div id="genderBarContainer" class="card"></div>
  </div>

</div>

<div id="bookList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>

<script>

const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSDLnokY9AAjmaXbQ4Ofk-jH6eK1mn9bXcgAid1xWU_2MbtoraDDL5IzoEYT7PPT-numSfmt0EJoS6a/pub?gid=1531654911&single=true&output=csv";

let genreChartInstance, languageChartInstance, countryChartInstance;

async function fetchBooks(){
  const res = await fetch(CSV_URL);
  const text = await res.text();
  const { data } = Papa.parse(text,{header:false,skipEmptyLines:true});
  return data.slice(5).map(row=>({
    Book: row[0]||"",
    Author: row[1]||"",
    Fiction: row[2]||"",
    Read: row[3]||"",
    "Date Finished": row[4]||"",
    Rating: row[5]||"",
    Gender: row[7]||"",
    Language: row[8]||"",
    Genre: row[9]||"Other",
    Country: row[11]||"",
    Cover: row[10]||""
  }));
}

function renderCurrentlyReading(books){
  const div=document.getElementById("currentlyReading");
  div.innerHTML="<h2 class='text-lg font-semibold mb-3'>ðŸ“– Currently Reading</h2>";
  const current=books.filter(b=>!b.Read || b.Read.toLowerCase()!=="finished");
  if(!current.length){ div.innerHTML+="<p>No books currently reading.</p>"; return;}
  current.forEach(b=>{
    div.innerHTML+=`
      <div class="mb-4">
        <p class="font-bold">${b.Book}</p>
        <p>${b.Author}</p>
      </div>
    `;
  });
}

function renderBooks(books){
  const container=document.getElementById("bookList");
  container.innerHTML="";
  const finished=books.filter(b=>b.Read && b.Read.toLowerCase()==="finished").reverse();

  finished.forEach(b=>{
    let barColor="#64748b";
    if((b.Fiction||"").toLowerCase().includes("non")) barColor="#c9a227";

    container.innerHTML+=`
      <div class="book-item">
        <p class="book-title">${b.Book}</p>
        <div class="book-content">
          <img class="book-cover" src="${b.Cover}">
          <div class="book-info">
            <div style="height:4px;background:${barColor};border-radius:2px;margin-bottom:0.75rem;"></div>
            <p><strong>Author:</strong> ${b.Author}</p>
            <p><strong>Genre:</strong> ${b.Genre}</p>
            <p><strong>Language:</strong> ${b.Language}</p>
            <p><strong>Date:</strong> ${b["Date Finished"]}</p>
            <p><strong>Rating:</strong> ${b.Rating}</p>
          </div>
        </div>
      </div>
    `;
  });
}

function renderCharts(books){
  const genre={}, lang={}, country={};
  books.forEach(b=>{
    genre[b.Genre]=(genre[b.Genre]||0)+1;
    if(b.Language) lang[b.Language]=(lang[b.Language]||0)+1;
    if(b.Country) country[b.Country]=(country[b.Country]||0)+1;
  });

  genreChartInstance = new Chart(document.getElementById("genreChart"),{
    type:"pie",
    data:{labels:Object.keys(genre),datasets:[{data:Object.values(genre)}]}
  });

  languageChartInstance = new Chart(document.getElementById("languageChart"),{
    type:"pie",
    data:{labels:Object.keys(lang),datasets:[{data:Object.values(lang)}]}
  });

  countryChartInstance = new Chart(document.getElementById("countryChart"),{
    type:"pie",
    data:{labels:Object.keys(country),datasets:[{data:Object.values(country)}]}
  });
}

async function init(){
  const books=await fetchBooks();
  renderCurrentlyReading(books);
  renderBooks(books);
  renderCharts(books);
}

init();
</script>

</body>
</html>